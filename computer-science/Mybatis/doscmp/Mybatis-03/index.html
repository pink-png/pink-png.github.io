<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="死肥宅" href="https://pink-png.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="死肥宅" href="https://pink-png.github.io/atom.xml"><link rel="alternate" type="application/json" title="死肥宅" href="https://pink-png.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Mybatis"><link rel="canonical" href="https://pink-png.github.io/computer-science/Mybatis/doscmp/Mybatis-03/"><title>Step.3 - Mybatis基础 - Mybatis - 计算机科学 | Yume Shoka = 死肥宅 = 肥宅快乐水</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Step.3</h1><div class="meta"><span class="item" title="创建时间：2020-03-13 09:30:48"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-03-13T09:30:48+08:00">2020-03-13</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Yume Shoka</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://cdn.cdnjson.com/tva4.sinaimg.cn/large/6833939bly1giclxp31goj20zk0m8qv5.jpg"></li><li class="item" data-background-image="https://cdn.cdnjson.com/tva4.sinaimg.cn/large/6833939bly1gipevuctzzj20zk0m84qp.jpg"></li><li class="item" data-background-image="https://cdn.cdnjson.com/tva4.sinaimg.cn/large/6833939bly1giclhfehz7j20zk0m8u0x.jpg"></li><li class="item" data-background-image="https://cdn.cdnjson.com/tva4.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li><li class="item" data-background-image="https://cdn.cdnjson.com/tva4.sinaimg.cn/large/6833939bly1gicm0n457cj20zk0m8e81.jpg"></li><li class="item" data-background-image="https://cdn.cdnjson.com/tva4.sinaimg.cn/large/6833939bly1giciukx8a7j20zk0m8aio.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/Mybatis/" itemprop="item" rel="index" title="分类于 Mybatis"><span itemprop="name">Mybatis</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/Mybatis/Mybatis%E5%9F%BA%E7%A1%80/" itemprop="item" rel="index" title="分类于 Mybatis基础"><span itemprop="name">Mybatis基础</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://pink-png.github.io/computer-science/Mybatis/doscmp/Mybatis-03/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="sanxin98"><meta itemprop="description" content="肥宅快乐水, 编程 & 生活"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="死肥宅"></span><div class="body md" itemprop="articleBody"><h1 id="Mybatis-3"><a href="#Mybatis-3" class="headerlink" title="Mybatis-3"></a>Mybatis-3</h1><h2 id="0-案例环境"><a href="#0-案例环境" class="headerlink" title="0. 案例环境"></a>0. 案例环境</h2><h3 id="0-1-案例数据初始化sql"><a href="#0-1-案例数据初始化sql" class="headerlink" title="0.1 案例数据初始化sql"></a>0.1 案例数据初始化sql</h3><pre><code class="mysql">CREATE DATABASE /*!32312 IF NOT EXISTS*/`mybatis_db` /*!40100 DEFAULT CHARACTER SET utf8 */;

USE `mybatis_db`;
DROP TABLE IF EXISTS `orders`;
CREATE TABLE `orders` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `createtime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#39;创建时间&#39;,
  `price` int(11) DEFAULT NULL COMMENT &#39;价格&#39;,
  `remark` varchar(100) DEFAULT NULL COMMENT &#39;备注&#39;,
  `user_id` int(11) DEFAULT NULL COMMENT &#39;用户id&#39;,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;
insert  into `orders`(`id`,`createtime`,`price`,`remark`,`user_id`) values (1,&#39;2014-06-26 16:55:43&#39;,2000,&#39;无&#39;,2),(2,&#39;2021-02-23 16:55:57&#39;,3000,&#39;无&#39;,3),(3,&#39;2021-02-23 16:56:21&#39;,4000,&#39;无&#39;,2);
DROP TABLE IF EXISTS `role`;

CREATE TABLE `role` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) DEFAULT NULL COMMENT &#39;角色名&#39;,
  `desc` varchar(100) DEFAULT NULL COMMENT &#39;角色描述&#39;,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

/*Data for the table `role` */

insert  into `role`(`id`,`name`,`desc`) values (1,&#39;总经理&#39;,&#39;一人之下&#39;),(2,&#39;CFO&#39;,NULL);

/*Table structure for table `user` */

DROP TABLE IF EXISTS `user`;

CREATE TABLE `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(50) DEFAULT NULL,
  `age` int(11) DEFAULT NULL,
  `address` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=33 DEFAULT CHARSET=utf8;

/*Data for the table `user` */

insert  into `user`(`id`,`username`,`age`,`address`) values (2,&#39;pdd&#39;,26,NULL),(3,&#39;UZI&#39;,19,&#39;上海11&#39;),(4,&#39;RF&#39;,19,NULL);

/*Table structure for table `user_role` */

DROP TABLE IF EXISTS `user_role`;

CREATE TABLE `user_role` (
  `user_id` int(11) DEFAULT NULL,
  `role_id` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*Data for the table `user_role` */

insert  into `user_role`(`user_id`,`role_id`) values (2,2),(2,1),(3,1);
</code></pre><h3 id="0-2-实体类"><a href="#0-2-实体类" class="headerlink" title="0.2 实体类"></a>0.2 实体类</h3><h4 id="0-2-1-User-java"><a href="#0-2-1-User-java" class="headerlink" title="0.2.1 User.java"></a>0.2.1 User.java</h4><pre><code class="java">public class User &#123;

    private Integer id;

    private String username;

    private Integer age;

    private String address;


    @Override
    public String toString() &#123;
        return &quot;User&#123;&quot; +
                &quot;id=&quot; + id +
                &quot;, username=&#39;&quot; + username + &#39;\&#39;&#39; +
                &quot;, age=&quot; + age +
                &quot;, address=&#39;&quot; + address + &#39;\&#39;&#39; +
                &#39;&#125;&#39;;
    &#125;

    public Integer getId() &#123;
        return id;
    &#125;

    public void setId(Integer id) &#123;
        this.id = id;
    &#125;

    public String getUsername() &#123;
        return username;
    &#125;

    public void setUsername(String username) &#123;
        this.username = username;
    &#125;

    public Integer getAge() &#123;
        return age;
    &#125;

    public void setAge(Integer age) &#123;
        this.age = age;
    &#125;

    public String getAddress() &#123;
        return address;
    &#125;

    public void setAddress(String address) &#123;
        this.address = address;
    &#125;

    public User() &#123;
    &#125;

    public User(Integer id, String username, Integer age, String address) &#123;
        this.id = id;
        this.username = username;
        this.age = age;
        this.address = address;
    &#125;

&#125;
</code></pre><h4 id="0-2-2-Order-java"><a href="#0-2-2-Order-java" class="headerlink" title="0.2.2 Order.java"></a>0.2.2 Order.java</h4><pre><code class="java">public class Order &#123;
    private Integer id;
    private Date createtime;
    private Integer price;
    private String remark;
    private Integer userId;

    @Override
    public String toString() &#123;
        return &quot;Order&#123;&quot; +
                &quot;id=&quot; + id +
                &quot;, createtime=&quot; + createtime +
                &quot;, price=&quot; + price +
                &quot;, remark=&#39;&quot; + remark + &#39;\&#39;&#39; +
                &quot;, userId=&quot; + userId +
                &#39;&#125;&#39;;
    &#125;
      public Order() &#123;
    &#125;
    public Integer getId() &#123;
        return id;
    &#125;

    public void setId(Integer id) &#123;
        this.id = id;
    &#125;

    public Date getCreatetime() &#123;
        return createtime;
    &#125;

    public void setCreatetime(Date createtime) &#123;
        this.createtime = createtime;
    &#125;

    public Integer getPrice() &#123;
        return price;
    &#125;

    public void setPrice(Integer price) &#123;
        this.price = price;
    &#125;

    public String getRemark() &#123;
        return remark;
    &#125;

    public void setRemark(String remark) &#123;
        this.remark = remark;
    &#125;

    public Integer getUserId() &#123;
        return userId;
    &#125;

    public void setUserId(Integer userId) &#123;
        this.userId = userId;
    &#125;

    public Order(Integer id, Date createtime, Integer price, String remark, Integer userId) &#123;
        this.id = id;
        this.createtime = createtime;
        this.price = price;
        this.remark = remark;
        this.userId = userId;
    &#125;
&#125;
</code></pre><h4 id="0-2-3-Role-java"><a href="#0-2-3-Role-java" class="headerlink" title="0.2.3 Role.java"></a>0.2.3 Role.java</h4><pre><code class="java">
public class Role &#123;
    private Integer id;
    private String name;
    private String desc;

    @Override
    public String toString() &#123;
        return &quot;Role&#123;&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&#39;&quot; + name + &#39;\&#39;&#39; +
                &quot;, desc=&#39;&quot; + desc + &#39;\&#39;&#39; +
                &#39;&#125;&#39;;
    &#125;
    public Role() &#123;
    &#125;
    public Integer getId() &#123;
        return id;
    &#125;

    public void setId(Integer id) &#123;
        this.id = id;
    &#125;

    public String getName() &#123;
        return name;
    &#125;

    public void setName(String name) &#123;
        this.name = name;
    &#125;

    public String getDesc() &#123;
        return desc;
    &#125;

    public void setDesc(String desc) &#123;
        this.desc = desc;
    &#125;

    public Role(Integer id, String name, String desc) &#123;
        this.id = id;
        this.name = name;
        this.desc = desc;
    &#125;
&#125;
</code></pre><h2 id="1-ResultMap"><a href="#1-ResultMap" class="headerlink" title="1. ResultMap"></a>1. ResultMap</h2><h3 id="1-1-基本使用"><a href="#1-1-基本使用" class="headerlink" title="1.1 基本使用"></a>1.1 基本使用</h3><p>​	我们可以使用resultMap标签自定义结果集和实体类属性的映射规则。</p><pre><code class="xml">    &lt;!--
        resultMap 用来自定义结果集和实体类的映射
            属性：
                id 相当于这个resultMap的唯一标识
                type 用来指定映射到哪个实体类
        id标签  用来指定主键列的映射规则
            属性：
                property 要映射的属性名
                column  对应的列名
        result标签 用来指定普通列的映射规则
            属性：
                property 要映射的属性名
                column 对应的列名
    --&gt;
    &lt;resultMap id=&quot;orderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; &gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;price&quot; property=&quot;price&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;remark&quot; property=&quot;remark&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;

    &lt;!--使用我们自定义的映射规则--&gt;
    &lt;select id=&quot;findAll&quot; resultMap=&quot;orderMap&quot;&gt;
        SELECT id,createtime,price,remark,user_id  FROM ORDERS
    &lt;/select&gt;
    
</code></pre><h3 id="1-2-自动映射"><a href="#1-2-自动映射" class="headerlink" title="1.2 自动映射"></a>1.2 自动映射</h3><p>​	我们定义resultMap时默认情况下自动映射是开启状态的。也就是如果结果集的列名和我们的属性名相同是会自动映射的我们只需要写特殊情况的映射关系即可。</p><p>例如：</p><p>下面这种写法和上面的写法会有相同的效果，因为其他属性的属性名和结果集的列名都是相同的会自动映射。</p><pre><code class="xml">    &lt;resultMap id=&quot;orderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; &gt;
        &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
    &lt;!--使用我们自定义的映射规则--&gt;
    &lt;select id=&quot;findAll&quot; resultMap=&quot;orderMap&quot;&gt;
        SELECT id,createtime,price,remark,user_id  FROM ORDERS
    &lt;/select&gt;
</code></pre><p>​	如有需要可以选择关闭自动映射可以把resultMap的autoMapping属性设置为false。</p><p>例如：</p><pre><code class="xml">    &lt;resultMap id=&quot;orderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; autoMapping=&quot;false&quot;&gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;price&quot; property=&quot;price&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;remark&quot; property=&quot;remark&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
</code></pre><h3 id="1-3-继承映射关系"><a href="#1-3-继承映射关系" class="headerlink" title="1.3 继承映射关系"></a>1.3 继承映射关系</h3><p>​	我们可以使用resultMap 的extends属性来指定一个resultMap，从而复用重复的映射关系配置。</p><p>例如：</p><pre><code class="xml">      &lt;!--定义个父映射，供其他resultMap继承--&gt;
    &lt;resultMap id=&quot;baseOrderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; &gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;price&quot; property=&quot;price&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;remark&quot; property=&quot;remark&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
    &lt;!--继承baseOrderMap，然后只需要写自己特有的映射关系即可--&gt;
    &lt;resultMap id=&quot;orderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; autoMapping=&quot;false&quot; extends=&quot;baseOrderMap&quot;&gt;
        &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
</code></pre><h2 id="2-多表查询"><a href="#2-多表查询" class="headerlink" title="2. 多表查询"></a>2. 多表查询</h2><p>​	有的时候我们需要查询多张表的数据才可以得到我们要的结果。</p><p>​	我们可以直接写一个多表关联的SQL进行查询。也可以分步进行多次的查询来拿到我们需要的结果。</p><p>​	Mybatis就提供了对应的配置，可以让我们去更方便的进行相应的查询和对应的结果集处理。</p><h3 id="2-1-多表关联查询"><a href="#2-1-多表关联查询" class="headerlink" title="2.1 多表关联查询"></a>2.1 多表关联查询</h3><h4 id="2-1-1-一对一关系"><a href="#2-1-1-一对一关系" class="headerlink" title="2.1.1 一对一关系"></a>2.1.1 一对一关系</h4><p>​	两个实体之间是一对一的关系。(例如我们需要查询订单，要求还需要下单用户的数据。这里的订单相对于用户是一对一。)</p><p>例如：</p><p>方法定义如下</p><pre><code class="java">    //根据订单id查询订单，要求把下单用户的信息也查询出来
    Order findById(Integer id);
</code></pre><p>因为期望Order中还能包含下单用户的数据，所以可以再Order中增加一个属性</p><pre><code class="java">private User user;
</code></pre><p>SQL语句如下</p><pre><code class="mysql">
SELECT 
    o.id,o.`createtime`,o.`price`,o.`remark`,o.`user_id`,u.`id` uid,u.`username`,u.`age`,u.`address`
FROM 
    orders o,USER u
WHERE
    o.`user_id` = u.`id`
    AND o.id = 2
</code></pre><p>结果集</p><p><img data-src="/images%5Cimgmybatis%5Cimage-2.png" alt="image-20210224155400455"></p><p>我们可以使用如下两种方式封装结果集。</p><h5 id="2-1-1-1-使用ResultMap对所有字段进行映射"><a href="#2-1-1-1-使用ResultMap对所有字段进行映射" class="headerlink" title="2.1.1.1 使用ResultMap对所有字段进行映射"></a>2.1.1.1 使用ResultMap对所有字段进行映射</h5><p>​	可以使用ResultMap设置user对象的属性的映射规则。</p><p>①resultMap定义，主要是对user对象的属性设置映射规则</p><pre><code class="xml">     &lt;resultMap id=&quot;baseOrderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; &gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;price&quot; property=&quot;price&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;remark&quot; property=&quot;remark&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;

    &lt;resultMap id=&quot;orderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; autoMapping=&quot;false&quot; extends=&quot;baseOrderMap&quot;&gt;
        &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;

    &lt;!--Order和User关联的映射--&gt;
    &lt;resultMap id=&quot;orderUserMap&quot; type=&quot;com.sangeng.pojo.Order&quot; autoMapping=&quot;false&quot; extends=&quot;orderMap&quot;&gt;
        &lt;result property=&quot;user.id&quot; column=&quot;uid&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;user.username&quot; column=&quot;username&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;user.age&quot; column=&quot;age&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;user.address&quot; column=&quot;address&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
</code></pre><p>②使用定义好的resultMap</p><pre><code class="xml">&lt;!--根据订单id查询订单，要求把下单用户的信息也查询出来--&gt;
    &lt;select id=&quot;findById&quot; resultMap=&quot;orderUserMap&quot;&gt;
        SELECT
            o.`id`,o.`createtime`,o.`price`,o.`remark`,o.`user_id`,u.`id` uid,u.`username`,u.`age`,u.`address`
        FROM
            orders o,`user` u
        WHERE
            o.id = #&#123;id&#125; AND
            o.`user_id`=u.`id`
    &lt;/select&gt;
</code></pre><h5 id="2-1-1-2-使用ResultMap中的association"><a href="#2-1-1-2-使用ResultMap中的association" class="headerlink" title="2.1.1.2 使用ResultMap中的association"></a>2.1.1.2 使用ResultMap中的association</h5><p>​	可以使用ResultMap中的子标签association 来设置关联实体类的映射规则.</p><p>①定义resultMap</p><pre><code class="xml">     &lt;resultMap id=&quot;baseOrderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; &gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;price&quot; property=&quot;price&quot;&gt;&lt;/result&gt;
        &lt;result column=&quot;remark&quot; property=&quot;remark&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;

    &lt;resultMap id=&quot;orderMap&quot; type=&quot;com.sangeng.pojo.Order&quot; autoMapping=&quot;false&quot; extends=&quot;baseOrderMap&quot;&gt;
        &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;

    &lt;!--Order和User关联的映射（使用association）--&gt;
    &lt;resultMap id=&quot;orderUserMapUseAssociation&quot; type=&quot;com.sangeng.pojo.Order&quot; autoMapping=&quot;false&quot; extends=&quot;orderMap&quot;&gt;
        &lt;association property=&quot;user&quot; javaType=&quot;com.sangeng.pojo.User&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;uid&quot;&gt;&lt;/id&gt;
            &lt;result property=&quot;username&quot; column=&quot;username&quot;&gt;&lt;/result&gt;
            &lt;result property=&quot;age&quot; column=&quot;age&quot;&gt;&lt;/result&gt;
            &lt;result property=&quot;address&quot; column=&quot;address&quot;&gt;&lt;/result&gt;
        &lt;/association&gt;
    &lt;/resultMap&gt;
</code></pre><p>②使用resultMap</p><pre><code class="xml">&lt;!--根据订单id查询订单，要求把下单用户的信息也查询出来--&gt;
    &lt;select id=&quot;findById&quot; resultMap=&quot;orderUserMapUseAssociation&quot;&gt;
        SELECT
            o.`id`,o.`createtime`,o.`price`,o.`remark`,o.`user_id`,u.`id` uid,u.`username`,u.`age`,u.`address`
        FROM
            orders o,`user` u
        WHERE
            o.id = #&#123;id&#125; AND
            o.`user_id`=u.`id`
    &lt;/select&gt;
</code></pre><h4 id="2-1-2-一对多关系"><a href="#2-1-2-一对多关系" class="headerlink" title="2.1.2 一对多关系"></a>2.1.2 一对多关系</h4><p>​	两个实体之间是一对多的关系。(例如我们需要查询用户，要求还需要该用户所具有的角色信息。这里的用户相对于角色是一对多的。)</p><p>例如：</p><p>方法定义如下</p><pre><code class="java">    //根据id查询用户，并且要求把该用户所具有的角色信息也查询出来
    User findById(Integer id);
</code></pre><p>因为期望User中还能包含该用户所具有的角色信息，所以可以在User中增加一个属性</p><pre><code class="java">//    该用户所具有的角色
    private List&lt;Role&gt; roles;
</code></pre><p>SQL语句如下</p><pre><code class="mysql">SELECT 
    u.`id`,u.`username`,u.`age`,u.`address`,r.id rid,r.name,r.desc
FROM 
    USER u,user_role ur,role r
WHERE 
    u.id=ur.user_id AND ur.role_id = r.id
    AND u.id = 2
</code></pre><p>结果集</p><p><img data-src="/images%5Cimgmybatis%5Cimage-4.png" alt="image-20210224164927461"></p><p>我们可以使用如下的方式封装结果集。</p><h5 id="2-1-2-1-使用ResultMap中的collection"><a href="#2-1-2-1-使用ResultMap中的collection" class="headerlink" title="2.1.2.1 使用ResultMap中的collection"></a>2.1.2.1 使用ResultMap中的collection</h5><p>​	可以使用ResultMap中的子标签association 来设置关联实体类的映射规则.</p><p>①定义ResultMap</p><pre><code class="xml">    &lt;!--定义User基本属性映射规则--&gt;
    &lt;resultMap id=&quot;userMap&quot; type=&quot;com.sangeng.pojo.User&quot;&gt;
        &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result property=&quot;username&quot; column=&quot;username&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;age&quot; column=&quot;age&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;address&quot; column=&quot;address&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
    
    &lt;resultMap id=&quot;userRoleMap&quot; type=&quot;com.sangeng.pojo.User&quot;  extends=&quot;userMap&quot;&gt;
        &lt;collection property=&quot;roles&quot; ofType=&quot;com.sangeng.pojo.Role&quot; &gt;
            &lt;id property=&quot;id&quot; column=&quot;rid&quot;&gt;&lt;/id&gt;
            &lt;result property=&quot;name&quot; column=&quot;name&quot;&gt;&lt;/result&gt;
            &lt;result property=&quot;desc&quot; column=&quot;desc&quot;&gt;&lt;/result&gt;
        &lt;/collection&gt;
    &lt;/resultMap&gt;
</code></pre><p>②使用ResultMap</p><pre><code class="xml">    
    &lt;select id=&quot;findById&quot; resultMap=&quot;userRoleMap&quot; &gt;
        SELECT 
            u.`id`,u.`username`,u.`age`,u.`address`,r.id rid,r.name,r.desc
        FROM 
            USER u,user_role ur,role r
        WHERE 
            u.id=ur.user_id AND ur.role_id = r.id
            AND u.id = #&#123;id&#125;
    &lt;/select&gt;
</code></pre><p>最终封装完的结果如下：</p><p><img data-src="/images%5Cimgmybatis%5Cimage-5.png" alt="image-20210224170108202"></p><h3 id="2-2-分步查询"><a href="#2-2-分步查询" class="headerlink" title="2.2 分步查询"></a>2.2 分步查询</h3><p>​	如果有需要多表查询的需求我们也可以选择用多次查询的方式来查询出我们想要的数据。Mybatis也提供了对应的配置。</p><p>​	例如我们需要查询用户，要求还需要查询出该用户所具有的角色信息。我们可以选择先查询User表查询用户信息。然后在去查询关联的角色信息。</p><h4 id="2-2-1实现步骤"><a href="#2-2-1实现步骤" class="headerlink" title="2.2.1实现步骤"></a>2.2.1实现步骤</h4><p>​	具体步骤如下：</p><h5 id="①定义查询方法"><a href="#①定义查询方法" class="headerlink" title="①定义查询方法"></a>①定义查询方法</h5><p>​	因为我们要分两步查询: 1.查询User 2.根据用户的id查询Role 所以我们需要定义下面两个方法，并且把对应的标签也先写好</p><p>1.查询User</p><pre><code class="java">    //根据用户名查询用户，并且要求把该用户所具有的角色信息也查询出来
    User findByUsername(String username);
</code></pre><pre><code class="xml">    &lt;!--根据用户名查询用户--&gt;
    &lt;select id=&quot;findByUsername&quot; resultType=&quot;com.sangeng.pojo.User&quot;&gt;
        select id,username,age,address from user where username = #&#123;username&#125;
    &lt;/select&gt;
</code></pre><p>2.根据user_id查询Role</p><pre><code class="java">public interface RoleDao &#123;
    //根据userId查询所具有的角色
    List&lt;Role&gt; findRoleByUserId(Integer userId);
&#125;
</code></pre><pre><code class="xml">    &lt;!--根据userId查询所具有的角色--&gt;
    &lt;select id=&quot;findRoleByUserId&quot; resultType=&quot;com.sangeng.pojo.Role&quot;&gt;
        select 
            r.id,r.name,r.desc
        from 
            role r,user_role ur
        where 
            ur.role_id = r.id
            and ur.user_id = #&#123;userId&#125;
    &lt;/select&gt;
</code></pre><h5 id="②配置分步查询"><a href="#②配置分步查询" class="headerlink" title="②配置分步查询"></a>②配置分步查询</h5><p>​	我们期望的效果是调用findByUsername方法查询出来的结果中就包含角色的信息。所以我们可以设置findByUsername方法的RestltMap，指定分步查询</p><pre><code class="xml">    &lt;resultMap id=&quot;userMap&quot; type=&quot;com.sangeng.pojo.User&quot;&gt;
        &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt;&lt;/id&gt;
        &lt;result property=&quot;username&quot; column=&quot;username&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;age&quot; column=&quot;age&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;address&quot; column=&quot;address&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;
    &lt;!--
           select属性：指定用哪个查询来查询当前属性的数据 写法：包名.接口名.方法名
           column属性：设置当前结果集中哪列的数据作为select属性指定的查询方法需要参数
       --&gt;
    &lt;resultMap id=&quot;userRoleMapBySelect&quot; type=&quot;com.sangeng.pojo.User&quot; extends=&quot;userMap&quot;&gt;
        &lt;collection property=&quot;roles&quot;
                    ofType=&quot;com.sangeng.pojo.Role&quot;
                    select=&quot;com.sangeng.dao.RoleDao.findRoleByUserId&quot;
                    column=&quot;id&quot;&gt;
        &lt;/collection&gt;
    &lt;/resultMap&gt;
</code></pre><p>​	指定findByUsername使用我们刚刚创建的resultMap</p><pre><code class="xml">    &lt;!--根据用户名查询用户--&gt;
    &lt;select id=&quot;findByUsername&quot; resultMap=&quot;userRoleMapBySelect&quot;&gt;
        select id,username,age,address from user where username = #&#123;username&#125;
    &lt;/select&gt;
</code></pre><h4 id="2-2-2-设置按需加载"><a href="#2-2-2-设置按需加载" class="headerlink" title="2.2.2 设置按需加载"></a>2.2.2 设置按需加载</h4><p>​	我们可以设置按需加载，这样在我们代码中需要用到关联数据的时候才会去查询关联数据。</p><p>​	有两种方式可以配置分别是全局配置和局部配置</p><ol><li><p>局部配置</p><p>设置fetchType属性为lazy</p><pre><code class="xml">    &lt;resultMap id=&quot;userRoleMapBySelect&quot; type=&quot;com.sangeng.pojo.User&quot; extends=&quot;userMap&quot;&gt;
        &lt;collection property=&quot;roles&quot;
                    ofType=&quot;com.sangeng.pojo.Role&quot;
                    select=&quot;com.sangeng.dao.RoleDao.findRoleByUserId&quot;
                    column=&quot;id&quot; fetchType=&quot;lazy&quot;&gt;
        &lt;/collection&gt;
    &lt;/resultMap&gt;
</code></pre></li><li><p>全局配置</p><p>设置lazyLoadingEnabled为true</p><pre><code class="xml">    &lt;settings&gt;
       &lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;
    &lt;/settings&gt;
</code></pre></li></ol><h2 id="3-分页查询-PageHelper"><a href="#3-分页查询-PageHelper" class="headerlink" title="3.分页查询-PageHelper"></a>3.分页查询-PageHelper</h2><p>​	我们可以使用PageHelper非常方便的帮我们实现分页查询的需求。不需要自己在SQL中拼接SQL相关参数，并且能非常方便的获取的总页数总条数等分页相关数据。</p><h3 id="3-1-实现步骤"><a href="#3-1-实现步骤" class="headerlink" title="3.1 实现步骤"></a>3.1 实现步骤</h3><h4 id="①定义方法查询方法以及生成对应标签"><a href="#①定义方法查询方法以及生成对应标签" class="headerlink" title="①定义方法查询方法以及生成对应标签"></a>①定义方法查询方法以及生成对应标签</h4><pre><code class="java">    List&lt;User&gt; findAll();
</code></pre><pre><code class="xml">    &lt;select id=&quot;findAll&quot; resultType=&quot;com.sangeng.pojo.User&quot;&gt;
        select id,username,age,address from user
    &lt;/select&gt;
</code></pre><h4 id="②-引入依赖"><a href="#②-引入依赖" class="headerlink" title="② 引入依赖"></a>② 引入依赖</h4><pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
    &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
    &lt;version&gt;4.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><h4 id="③-配置Mybatis核心配置文件使用分页插件"><a href="#③-配置Mybatis核心配置文件使用分页插件" class="headerlink" title="③ 配置Mybatis核心配置文件使用分页插件"></a>③ 配置Mybatis核心配置文件使用分页插件</h4><pre><code class="xml"> &lt;plugins&gt;
        &lt;!-- 注意：分页助手的插件  配置在通用馆mapper之前 --&gt;
        &lt;plugin interceptor=&quot;com.github.pagehelper.PageHelper&quot;&gt;
            &lt;!-- 指定方言 --&gt;
            &lt;property name=&quot;dialect&quot; value=&quot;mysql&quot;/&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
</code></pre><h4 id="④-开始分页查询"><a href="#④-开始分页查询" class="headerlink" title="④ 开始分页查询"></a>④ 开始分页查询</h4><p>我们只需要在使用查询方法前设置分页参数即可</p><pre><code class="java">    //设置分页参数
    UserDao userDao = session.getMapper(UserDao.class);
    //设置分页查询参数
    PageHelper.startPage(1,1);
    List&lt;User&gt; users = userDao.findAll();
    System.out.println(users.get(0));
</code></pre><p>如果需要获取总页数总条数等分页相关数据，只需要创建一个PageInfo对象，把刚刚查询出的返回值做为构造方法参数传入。然后使用pageInfo对象获取即可。</p><pre><code class="java">    PageInfo&lt;User&gt; pageInfo = new PageInfo&lt;User&gt;(users);
    System.out.println(&quot;总条数：&quot;+pageInfo.getTotal());
    System.out.println(&quot;总页数：&quot;+pageInfo.getPages());
    System.out.println(&quot;当前页：&quot;+pageInfo.getPageNum());
    System.out.println(&quot;每页显示长度：&quot;+pageInfo.getPageSize());
</code></pre><h3 id="3-2-一对多多表查询分页问题"><a href="#3-2-一对多多表查询分页问题" class="headerlink" title="3.2 一对多多表查询分页问题"></a>3.2 一对多多表查询分页问题</h3><p>​	我们在进行一对多的多表查询时，如果使用了PageHelper进行分页。会出现关联数据不全的情况。我们可以使用分步查询的方式解决该问题。</p><h2 id="4-Mybatis缓存"><a href="#4-Mybatis缓存" class="headerlink" title="4.Mybatis缓存"></a>4.Mybatis缓存</h2><p>​	Mybatis的缓存其实就是把之前查到的数据存入内存（map）,下次如果还是查相同的东西，就可以直接从缓存中取，从而提高效率。</p><p>​	Mybatis有一级缓存和二级缓存之分，一级缓存（默认开启）是sqlsession级别的缓存。二级缓存相当于mapper级别的缓存。</p><h3 id="4-1-一级缓存"><a href="#4-1-一级缓存" class="headerlink" title="4.1 一级缓存"></a>4.1 一级缓存</h3><p>几种不会使用一级缓存的情况<br>1.调用相同方法但是传入的参数不同<br>2.调用相同方法参数也相同，但是使用的是另外一个SqlSession<br>3.如果查询完后，对同一个表进行了增，删改的操作，都会清空这sqlSession上的缓存<br>4.如果手动调用SqlSession的clearCache方法清除缓存了，后面也使用不了缓存</p><h3 id="4-2-二级缓存"><a href="#4-2-二级缓存" class="headerlink" title="4.2 二级缓存"></a>4.2 二级缓存</h3><p>​	注意：只在sqlsession调用了close或者commit后的数据才会进入二级缓存。</p><h4 id="4-2-1-开启二级缓存"><a href="#4-2-1-开启二级缓存" class="headerlink" title="4.2.1 开启二级缓存"></a>4.2.1 开启二级缓存</h4><p>①全局开启</p><p>在Mybatis核心配置文件中配置</p><pre><code class="xml">    &lt;settings&gt;
        &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;
    &lt;/settings&gt;
</code></pre><p>②局部开启</p><p>在要开启二级缓存的mapper映射文件中设置 cache标签</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;
&lt;mapper namespace=&quot;com.sangeng.dao.RoleDao&quot;&gt;
    &lt;cache&gt;&lt;/cache&gt;
&lt;/mapper&gt;
</code></pre><h4 id="4-2-2-使用建议"><a href="#4-2-2-使用建议" class="headerlink" title="4.2.2 使用建议"></a>4.2.2 使用建议</h4><p>​	二级缓存在实际开发中基本不会使用。</p><h2 id="5-Mybatis原理-单独专题讲解"><a href="#5-Mybatis原理-单独专题讲解" class="headerlink" title="5.Mybatis原理-单独专题讲解"></a>5.Mybatis原理-单独专题讲解</h2><div class="tags"><a href="/tags/Mybatis/" rel="tag"><i class="ic i-tag"></i> Mybatis</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-07-07 15:43:25" itemprop="dateModified" datetime="2023-07-07T15:43:25+08:00">2023-07-07</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="sanxin98 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="sanxin98 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>sanxin98 <i class="ic i-at"><em>@</em></i>死肥宅</li><li class="link"><strong>本文链接：</strong> <a href="https://pink-png.github.io/computer-science/Mybatis/doscmp/Mybatis-03/" title="Step.3">https://pink-png.github.io/computer-science/Mybatis/doscmp/Mybatis-03/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/computer-science/spring/docssp/Spring-01/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;cdn.cdnjson.com&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipexj2jgzj20zk0m8b09.jpg" title="Step.1"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Spring基础</span><h3>Step.1</h3></a></div><div class="item right"><a href="/computer-science/Mybatis/doscmp/Mybatis-01/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;cdn.cdnjson.com&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclflwv2aj20zk0m84qp.jpg" title="Step.1"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Mybatis基础</span><h3>Step.1</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybatis-3"><span class="toc-number">1.</span> <span class="toc-text">Mybatis-3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E6%A1%88%E4%BE%8B%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.</span> <span class="toc-text">0. 案例环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1-%E6%A1%88%E4%BE%8B%E6%95%B0%E6%8D%AE%E5%88%9D%E5%A7%8B%E5%8C%96sql"><span class="toc-number">1.1.1.</span> <span class="toc-text">0.1 案例数据初始化sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-2-%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">1.1.2.</span> <span class="toc-text">0.2 实体类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0-2-1-User-java"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">0.2.1 User.java</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0-2-2-Order-java"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">0.2.2 Order.java</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0-2-3-Role-java"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">0.2.3 Role.java</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-ResultMap"><span class="toc-number">1.2.</span> <span class="toc-text">1. ResultMap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%87%AA%E5%8A%A8%E6%98%A0%E5%B0%84"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2 自动映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%BB%A7%E6%89%BF%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.3 继承映射关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.</span> <span class="toc-text">2. 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%A4%9A%E8%A1%A8%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 多表关联查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E7%B3%BB"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">2.1.1 一对一关系</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-1-%E4%BD%BF%E7%94%A8ResultMap%E5%AF%B9%E6%89%80%E6%9C%89%E5%AD%97%E6%AE%B5%E8%BF%9B%E8%A1%8C%E6%98%A0%E5%B0%84"><span class="toc-number">1.3.1.1.1.</span> <span class="toc-text">2.1.1.1 使用ResultMap对所有字段进行映射</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-2-%E4%BD%BF%E7%94%A8ResultMap%E4%B8%AD%E7%9A%84association"><span class="toc-number">1.3.1.1.2.</span> <span class="toc-text">2.1.1.2 使用ResultMap中的association</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">2.1.2 一对多关系</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-2-1-%E4%BD%BF%E7%94%A8ResultMap%E4%B8%AD%E7%9A%84collection"><span class="toc-number">1.3.1.2.1.</span> <span class="toc-text">2.1.2.1 使用ResultMap中的collection</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 分步查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">2.2.1实现步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%91%A0%E5%AE%9A%E4%B9%89%E6%9F%A5%E8%AF%A2%E6%96%B9%E6%B3%95"><span class="toc-number">1.3.2.1.1.</span> <span class="toc-text">①定义查询方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%91%A1%E9%85%8D%E7%BD%AE%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.2.1.2.</span> <span class="toc-text">②配置分步查询</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E8%AE%BE%E7%BD%AE%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">2.2.2 设置按需加载</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2-PageHelper"><span class="toc-number">1.4.</span> <span class="toc-text">3.分页查询-PageHelper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1 实现步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A0%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95%E6%9F%A5%E8%AF%A2%E6%96%B9%E6%B3%95%E4%BB%A5%E5%8F%8A%E7%94%9F%E6%88%90%E5%AF%B9%E5%BA%94%E6%A0%87%E7%AD%BE"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">①定义方法查询方法以及生成对应标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A1-%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">② 引入依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A2-%E9%85%8D%E7%BD%AEMybatis%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BD%BF%E7%94%A8%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">③ 配置Mybatis核心配置文件使用分页插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A3-%E5%BC%80%E5%A7%8B%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">④ 开始分页查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%88%86%E9%A1%B5%E9%97%AE%E9%A2%98"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2 一对多多表查询分页问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Mybatis%E7%BC%93%E5%AD%98"><span class="toc-number">1.5.</span> <span class="toc-text">4.Mybatis缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1 一级缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.2 二级缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E5%BC%80%E5%90%AF%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">4.2.1 开启二级缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">4.2.2 使用建议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Mybatis%E5%8E%9F%E7%90%86-%E5%8D%95%E7%8B%AC%E4%B8%93%E9%A2%98%E8%AE%B2%E8%A7%A3"><span class="toc-number">1.6.</span> <span class="toc-text">5.Mybatis原理-单独专题讲解</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/computer-science/Mybatis/doscmp/Mybatis-01/" rel="bookmark" title="Step.1">Step.1</a></li><li class="active"><a href="/computer-science/Mybatis/doscmp/Mybatis-03/" rel="bookmark" title="Step.3">Step.3</a></li><li><a href="/computer-science/Mybatis/doscmp/Mybatis-02/" rel="bookmark" title="Step.2">Step.2</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="sanxin98" data-src="/images/avatar.jpg"><p class="name" itemprop="name">sanxin98</p><div class="description" itemprop="description">编程 & 生活</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">93</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">37</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">27</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3BpbmstcG5n" title="https:&#x2F;&#x2F;github.com&#x2F;pink-png"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/computer-science/spring/docssp/Spring-01/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/computer-science/Mybatis/doscmp/Mybatis-01/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/Javascript/" title="分类于 Javascript">Javascript</a></div><span><a href="/js-base/js%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E6%B5%81/" title="js中的事件">js中的事件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/" title="分类于 微信公众号">微信公众号</a></div><span><a href="/front-end/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7html%20js%20%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95/" title="微信公众号html js 实现登录">微信公众号html js 实现登录</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/react0-1/" title="分类于 react">react</a></div><span><a href="/computer-science/react0-1/redux/" title="step.4 redux">step.4 redux</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/vueyuanma/" title="分类于 Vue">Vue</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/vueyuanma/dosc/" title="分类于 vue2.x源码">vue2.x源码</a></div><span><a href="/computer-science/vueyuanma/dosc/13%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BA%86%E8%A7%A3v-model%E7%9A%84%E8%AF%AD%E6%B3%95%E7%B3%96%E4%BA%86%E5%90%97/" title="Step.13 你真的了解v-model的语法糖了吗">Step.13 你真的了解v-model的语法糖了吗</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="分类于 前端性能优化">前端性能优化</a></div><span><a href="/performance-optimization/Web%20Worker/" title="Web Worker">Web Worker</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/react0-1/" title="分类于 react">react</a></div><span><a href="/front-end/React%E5%B8%B8%E7%94%A8%E5%9F%BA%E7%A1%80/" title="React基础">React基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/Javascript/" title="分类于 Javascript">Javascript</a></div><span><a href="/js-base/js%E5%85%B3%E4%BA%8EArray%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/" title="关于Array处理数据的方法总结">关于Array处理数据的方法总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Mybatis/" title="分类于 Mybatis">Mybatis</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Mybatis/Mybatis%E5%9F%BA%E7%A1%80/" title="分类于 Mybatis基础">Mybatis基础</a></div><span><a href="/computer-science/Mybatis/doscmp/Mybatis-03/" title="Step.3">Step.3</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="分类于 前端设计模式">前端设计模式</a></div><span><a href="/front-end/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="前端设计模式">前端设计模式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" title="分类于 前端开发">前端开发</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/Javascript/" title="分类于 Javascript">Javascript</a></div><span><a href="/js-base/promise/" title="Promise">Promise</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">sanxin98 @ Yume Shoka</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"computer-science/Mybatis/doscmp/Mybatis-03/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:{placeholder:"1. 提问前请先仔细阅读本文档⚡\n2. 页面显示问题💥，请提供控制台截图📸或者您的测试网址\n3. 其他任何报错💣，请提供详细描述和截图📸，祝食用愉快💪"},fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>